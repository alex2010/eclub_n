// Generated by CoffeeScript 1.9.1
module.exports = {
  _init: function(ctx) {
    ctx.css = ctx.cssPath('css');
    ctx.headMenu = 'sns';
    return {
      city: function(cb) {
        return dao.get(ctx.c.code, 'city', {
          title: 'Beijing'
        }, function(res) {
          return cb(null, res);
        });
      },
      menu: function(cb) {
        return dao.get(ctx.c.code, 'role', {
          title: 'guest'
        }, function(res) {
          var menu;
          menu = res.res.menu;
          return cb(null, menu);
        });
      }
    };
  },
  index: function(ctx) {
    return {
      sights: function(cb) {
        var filter;
        filter = {
          row: {
            $gt: 1000
          }
        };
        return dao.find(ctx.c.code, 'sight', filter, {}, function(res) {
          return cb(null, res);
        });
      }
    };
  },
  top: function(ctx) {
    ctx.headTitle = 'Top Collection In Beijing';
    return {
      sights: function(cb) {
        var filter;
        filter = {
          cat: 'top'
        };
        return dao.find(ctx.c.code, 'sight', filter, {}, function(res) {
          var i, it, len;
          ctx.slides = [];
          for (i = 0, len = res.length; i < len; i++) {
            it = res[i];
            if (it.row > 1000) {
              ctx.slides.push(it);
            }
          }
          return cb(null, res);
        });
      }
    };
  },
  sight: function(ctx) {
    return {
      _recommeded: function(cb) {
        var filter;
        filter = {
          cat: 'top'
        };
        return dao.find(ctx.c.code, 'sight', filter, {}, function(res) {
          return cb(null, res);
        });
      }
    };
  }
};
